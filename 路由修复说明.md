# 路由修复说明

## 问题描述

访问 `reports/dashboard` 时出现错误：
```
Controller not found: ReportsController
```

## 问题原因

路由系统期望控制器名称是复数形式（如 `ReportsController`），但实际控制器文件名是单数形式（如 `ReportController.php`）。

### 路由映射关系

- URL: `?r=reports/dashboard` → 期望: `ReportsController` → 实际: `ReportController.php` ❌
- URL: `?r=transactions/list` → 期望: `TransactionsController` → 实际: `TransactionController.php` ❌
- URL: `?r=settings/categories` → 期望: `SettingsController` → 实际: `SettingController.php` ❌
- URL: `?r=auth/login` → 期望: `AuthController` → 实际: `AuthController.php` ✅

## 修复方案

在 `app/core/Router.php` 中添加了路由到控制器的映射表，将复数路由名称映射到单数控制器名称：

```php
$controllerMap = [
  'reports' => 'Report',
  'transactions' => 'Transaction',
  'settings' => 'Setting',
  'auth' => 'Auth'
];
```

## 修复内容

✅ 修改了 `app/core/Router.php`
- 添加了控制器映射表
- 支持复数路由名称到单数控制器文件的映射
- 改进了错误提示信息

## 验证结果

✅ 所有路由现在都可以正常工作：

- `reports/dashboard` → `ReportController::dashboard()` ✅
- `transactions/list` → `TransactionController::list()` ✅
- `transactions/create` → `TransactionController::create()` ✅
- `settings/categories` → `SettingController::categories()` ✅
- `auth/login` → `AuthController::login()` ✅

## 测试方法

1. **访问 Dashboard**：
   ```
   http://localhost:8000/index.php?r=reports/dashboard
   ```

2. **访问交易列表**：
   ```
   http://localhost:8000/index.php?r=transactions/list
   ```

3. **访问设置页面**：
   ```
   http://localhost:8000/index.php?r=settings/categories
   ```

## 当前路由映射

| URL 路由 | 控制器类 | 控制器文件 |
|---------|---------|-----------|
| `reports/*` | `ReportController` | `ReportController.php` |
| `transactions/*` | `TransactionController` | `TransactionController.php` |
| `settings/*` | `SettingController` | `SettingController.php` |
| `auth/*` | `AuthController` | `AuthController.php` |

## 注意事项

- 如果将来添加新的控制器，需要在 `Router.php` 的 `$controllerMap` 中添加映射
- 或者保持路由名称和控制器文件名一致（都使用单数或都使用复数）

---

**修复时间**: 2025-12-13
**状态**: ✅ 已修复并验证

